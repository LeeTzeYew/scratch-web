# Scratch编辑器操作记录器浏览器扩展

## 简介

Scratch编辑器操作记录器是一个浏览器扩展，用于记录用户在Scratch编辑器中的交互操作。这个扩展可以捕获用户拖动积木、点击按钮、运行代码等行为，并将这些操作以结构化的数据形式记录下来，方便后续分析或回放。

## 功能特点

- 实时记录用户在Scratch编辑器中的各种操作
- 捕获拖动积木、点击按钮、运行代码等交互行为
- 记录操作的时间顺序和相关参数
- 提供录制状态指示和控制界面
- 支持将记录的数据导出为JSON文件
- 能够与主应用进行数据同步

## 安装方法

### 作为开发者加载

1. 下载或克隆本代码库
2. 打开Chrome浏览器，访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展"按钮
5. 选择本代码库中的 `browser-extension` 文件夹
6. 扩展将会安装并在工具栏中显示图标

## 使用方法

1. 访问Scratch编辑器页面：`https://leetzeyew.github.io/scratch-editor`
2. 点击浏览器工具栏中的扩展图标，打开控制面板
3. 点击"开始录制"按钮开始记录用户操作
4. 在Scratch编辑器中进行正常操作
5. 操作会被自动记录下来
6. 点击"停止录制"按钮结束记录
7. 点击"导出数据"按钮将记录的操作导出为JSON文件

详细的使用指南请参考 [USAGE_GUIDE.md](./USAGE_GUIDE.md)

## 与主应用集成

如需将录制的操作数据集成到您的主应用中，请参考 [INTEGRATION_GUIDE.md](./INTEGRATION_GUIDE.md)

## 项目结构

```
browser-extension/
├── manifest.json         # 扩展清单文件
├── popup.html            # 扩展弹出界面
├── README.md             # 说明文档
├── USAGE_GUIDE.md        # 使用指南
├── INTEGRATION_GUIDE.md  # 集成指南
├── js/
│   ├── background.js     # 后台脚本
│   ├── contentScript.js  # 内容脚本，注入到页面中
│   ├── popup.js          # 弹出界面脚本
│   └── main-app-receiver.js  # 主应用接收器脚本
├── css/
│   └── popup.css         # 弹出界面样式
└── icons/
    ├── icon16.png        # 16x16 图标
    ├── icon48.png        # 48x48 图标
    └── icon128.png       # 128x128 图标
```

## 技术实现

- 使用Chrome扩展API进行开发
- 通过content script注入到Scratch编辑器页面
- 使用DOM事件监听用户交互
- 采用postMessage进行跨窗口通信
- 使用Chrome存储API保存录制数据

## 故障排除

### 扩展无法加载

**问题**: 提示"无法加载清单"或"找不到图标文件"

**解决方案**:
1. 确保 `icons` 目录下包含所需的所有图标文件（icon16.png、icon48.png、icon128.png）
2. 如果没有图标文件，可以创建一个空的图标文件夹并添加PNG图片：
   ```
   mkdir -p browser-extension/icons
   ```
3. 可以从任何来源获取PNG图标并重命名，或使用在线工具生成图标

### 录制功能不工作

**问题**: 点击"开始录制"按钮后，操作没有被记录

**解决方案**:
1. 检查浏览器控制台是否有错误信息（按F12打开开发者工具）
2. 确保访问的是正确的Scratch编辑器URL（https://leetzeyew.github.io/scratch-editor）
3. 检查页面上是否显示红色的录制指示器
4. 尝试关闭其他扩展，可能有冲突
5. 重新加载页面和扩展

### 找不到录制的数据

**问题**: 停止录制后找不到保存的数据

**解决方案**:
1. 确保录制过程中有进行一些操作
2. 检查扩展的存储空间（在chrome://extensions/页面点击"检查视图"链接）
3. 尝试使用"导出数据"按钮手动导出
4. 如果使用localStorage存储，可以在控制台中输入`localStorage.getItem('scratch_operations')`查看数据

### 无法与主应用通信

**问题**: 扩展记录的数据无法发送到主应用

**解决方案**:
1. 确保主应用已正确集成接收器脚本
2. 检查控制台中是否有跨域通信错误
3. 确保在扩展设置中启用了"与主应用同步"选项
4. 尝试使用本地存储方式传递数据

## 调试方法

1. 打开Chrome开发者工具（按F12）
2. 选择"扩展"面板
3. 在扩展列表中找到"Scratch编辑器操作记录器"
4. 点击"检查视图"链接
5. 查看控制台输出和网络请求

## 贡献

欢迎提交问题报告、功能请求和代码贡献。

## 许可证

[MIT许可证](LICENSE) 